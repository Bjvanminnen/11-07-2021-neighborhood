let seed=123;function random(){return((seed=16807*seed%2147483647)-1)/2147483646}const randRange=(t,n)=>random()*(n-t)+t,normalizedAngle=t=>t<0?t+2*Math.PI:t;function initialize(t,n){const e=["613F75","c1ff9b","266dd3","00c2d1","f9e900","ff6542","ed33b9"].map(t=>"#"+t),i=.25*Math.min(t,n),o=t/2,a=n/2,l=[];for(let t=o-i;t<=o+i;t+=18)for(let n=a-i;n<=a+i;n+=18)l.push({id:[t,n].join(","),point:[t,n],vector:[randRange(-1,1),randRange(-1,1)],color:e[~~randRange(0,e.length)]});return l}function draw(t,n){const e=n=>{t.fillStyle="white",((n,e)=>{t.fillRect(n[0],n[1],1,1)})(n.point)},{width:i,height:o}=t.canvas;t.fillStyle="#00000005",t.fillRect(0,0,i,o),n.forEach(t=>e(t))}function findNearest(t,n){let e=t[0]===n?t[1]:t[0],i=1/0;return t.forEach(t=>{if(t===n)return;const o=(t.point[0]-n.point[0])**2+(t.point[1]-n.point[1])**2;o<i&&(i=o,e=t)}),e}function updateSingle(t,n){const e=t.point[0]-n[0],i=t.point[1]-n[1],o=Math.sqrt(e**2+i**2),a=Math.sqrt(t.vector[0]**2+t.vector[1]**2),l=a/o,r=Math.atan2(i,e),c=Math.atan2(t.point[1]+t.vector[1]-n[1],t.point[0]+t.vector[0]-n[0]);let d=normalizedAngle(r),h=normalizedAngle(c);d>Math.PI&&(d-=Math.PI,h=normalizedAngle(h-Math.PI));const s=h>=d&&h<d+Math.PI?1:-1,f=r+l*s;return{...t,point:[n[0]+Math.cos(f)*o,n[1]+Math.sin(f)*o],vector:[Math.cos(f+Math.PI/2*s)*a,Math.sin(f+Math.PI/2*s)*a]}}function update(t){const n=[];for(let e=0;e<t.length;e++){const i=updateSingle(t[e],findNearest(t,t[e]).point);n.push(i)}return n}function main(){const t=document.getElementById("canvas"),n=t.getContext("2d"),{width:e,height:i}=t;let o=initialize(e,i);n.fillStyle="#000000",n.fillRect(0,0,e,i),n.globalCompositeOperation="luminosity",setInterval(()=>{o=update(o),draw(n,o)},40)}main();
